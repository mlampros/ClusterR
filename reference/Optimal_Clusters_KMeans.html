<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Optimal number of Clusters for Kmeans or Mini-Batch-Kmeans — Optimal_Clusters_KMeans • ClusterR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimal number of Clusters for Kmeans or Mini-Batch-Kmeans — Optimal_Clusters_KMeans"><meta name="description" content="Optimal number of Clusters for Kmeans or Mini-Batch-Kmeans"><meta property="og:description" content="Optimal number of Clusters for Kmeans or Mini-Batch-Kmeans"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ClusterR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/the_clusterR_package.html">Functionality of the ClusterR package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mlampros/ClusterR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Optimal number of Clusters for Kmeans or Mini-Batch-Kmeans</h1>
      <small class="dont-index">Source: <a href="https://github.com/mlampros/ClusterR/blob/master/R/clustering_functions.R" class="external-link"><code>R/clustering_functions.R</code></a></small>
      <div class="d-none name"><code>Optimal_Clusters_KMeans.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Optimal number of Clusters for Kmeans or Mini-Batch-Kmeans</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Optimal_Clusters_KMeans</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">max_clusters</span>,</span>
<span>  criterion <span class="op">=</span> <span class="st">"variance_explained"</span>,</span>
<span>  fK_threshold <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  num_init <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  max_iters <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  initializer <span class="op">=</span> <span class="st">"kmeans++"</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  plot_clusters <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tol_optimal_init <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mini_batch_params <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>matrix or data frame</p></dd>


<dt id="arg-max-clusters">max_clusters<a class="anchor" aria-label="anchor" href="#arg-max-clusters"></a></dt>
<dd><p>either a numeric value, a contiguous or non-continguous numeric vector specifying the cluster search space</p></dd>


<dt id="arg-criterion">criterion<a class="anchor" aria-label="anchor" href="#arg-criterion"></a></dt>
<dd><p>one of <em>variance_explained</em>, <em>WCSSE</em>, <em>dissimilarity</em>, <em>silhouette</em>, <em>distortion_fK</em>, <em>AIC</em>, <em>BIC</em> and <em>Adjusted_Rsquared</em>. See details for more information.</p></dd>


<dt id="arg-fk-threshold">fK_threshold<a class="anchor" aria-label="anchor" href="#arg-fk-threshold"></a></dt>
<dd><p>a float number used in the 'distortion_fK' criterion</p></dd>


<dt id="arg-num-init">num_init<a class="anchor" aria-label="anchor" href="#arg-num-init"></a></dt>
<dd><p>number of times the algorithm will be run with different centroid seeds</p></dd>


<dt id="arg-max-iters">max_iters<a class="anchor" aria-label="anchor" href="#arg-max-iters"></a></dt>
<dd><p>the maximum number of clustering iterations</p></dd>


<dt id="arg-initializer">initializer<a class="anchor" aria-label="anchor" href="#arg-initializer"></a></dt>
<dd><p>the method of initialization. One of, <em>optimal_init</em>, <em>quantile_init</em>, <em>kmeans++</em> and <em>random</em>. See details for more information</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>a float number. If, in case of an iteration (iteration &gt; 1 and iteration &lt; max_iters) 'tol' is greater than the squared norm of the centroids, then kmeans has converged</p></dd>


<dt id="arg-plot-clusters">plot_clusters<a class="anchor" aria-label="anchor" href="#arg-plot-clusters"></a></dt>
<dd><p>either TRUE or FALSE, indicating whether the results of the <em>Optimal_Clusters_KMeans</em> function should be plotted</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>either TRUE or FALSE, indicating whether progress is printed during clustering</p></dd>


<dt id="arg-tol-optimal-init">tol_optimal_init<a class="anchor" aria-label="anchor" href="#arg-tol-optimal-init"></a></dt>
<dd><p>tolerance value for the 'optimal_init' initializer. The higher this value is, the far appart from each other the centroids are.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>integer value for random number generator (RNG)</p></dd>


<dt id="arg-mini-batch-params">mini_batch_params<a class="anchor" aria-label="anchor" href="#arg-mini-batch-params"></a></dt>
<dd><p>either NULL or a list of the following parameters : <em>batch_size</em>, <em>init_fraction</em>, <em>early_stop_iter</em>. If not NULL then the optimal number of clusters will be found based on the Mini-Batch-Kmeans. See the details and examples sections for more information.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a vector with the results for the specified criterion. If plot_clusters is TRUE then it plots also the results.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>—————criteria————————–</p>
<p><strong>variance_explained</strong> : the sum of the within-cluster-sum-of-squares-of-all-clusters divided by the total sum of squares</p>
<p><strong>WCSSE</strong>              : the sum of the within-cluster-sum-of-squares-of-all-clusters</p>
<p><strong>dissimilarity</strong>      : the average intra-cluster-dissimilarity of all clusters (the distance metric defaults to euclidean)</p>
<p><strong>silhouette</strong>         : the average silhouette width where first the average per cluster silhouette is computed and then the global average (the distance metric defaults to euclidean). To compute the silhouette width for each cluster separately see the 'silhouette_of_clusters()' function</p>
<p><strong>distortion_fK</strong>      : this criterion is based on the following paper, 'Selection of K in K-means clustering' (https://www.ee.columbia.edu/~dpwe/papers/PhamDN05-kmeans.pdf)</p>
<p><strong>AIC</strong>                : the Akaike information criterion</p>
<p><strong>BIC</strong>                : the Bayesian information criterion</p>
<p><strong>Adjusted_Rsquared</strong>  : the adjusted R^2 statistic</p>

<p>—————initializers———————-</p>
<p><strong>optimal_init</strong>   : this initializer adds rows of the data incrementally, while checking that they do not already exist in the centroid-matrix  [ experimental ]</p>
<p><strong>quantile_init</strong>  : initialization of centroids by using the cummulative distance between observations and by removing potential duplicates   [ experimental ]</p>
<p><strong>kmeans++</strong>       : kmeans++ initialization. Reference : http://theory.stanford.edu/~sergei/papers/kMeansPP-soda.pdf AND http://stackoverflow.com/questions/5466323/how-exactly-does-k-means-work</p>
<p><strong>random</strong>         : random selection of data rows as initial centroids</p>

<p>If the <em>mini_batch_params</em> parameter is not NULL then the optimal number of clusters will be found based on the Mini-batch-Kmeans algorithm, otherwise based on the Kmeans. The higher the <em>init_fraction</em>
parameter is the more close the results between Mini-Batch-Kmeans and Kmeans will be.</p>
<p>In case that the <em>max_clusters</em> parameter is a contiguous or non-contiguous vector then plotting is disabled. Therefore, plotting is enabled only if the <em>max_clusters</em> parameter is of length 1.
Moreover, the <em>distortion_fK</em> criterion can't be computed if the <em>max_clusters</em> parameter is a contiguous or non-continguous vector ( the <em>distortion_fK</em> criterion requires consecutive clusters ).
The same applies also to the <em>Adjusted_Rsquared</em> criterion which returns incorrect output.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>https://www.ee.columbia.edu/~dpwe/papers/PhamDN05-kmeans.pdf</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Lampros Mouselimis</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dietary_survey_IBS</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">=</span> <span class="va">dietary_survey_IBS</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dietary_survey_IBS</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="center_scale.html">center_scale</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-------</span></span></span>
<span class="r-in"><span><span class="co"># kmeans</span></span></span>
<span class="r-in"><span><span class="co">#-------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">opt_km</span> <span class="op">=</span> <span class="fu">Optimal_Clusters_KMeans</span><span class="op">(</span><span class="va">dat</span>, max_clusters <span class="op">=</span> <span class="fl">10</span>, criterion <span class="op">=</span> <span class="st">"distortion_fK"</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>                                 plot_clusters <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#------------------</span></span></span>
<span class="r-in"><span><span class="co"># mini-batch-kmeans</span></span></span>
<span class="r-in"><span><span class="co">#------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">params_mbkm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>batch_size <span class="op">=</span> <span class="fl">10</span>, init_fraction <span class="op">=</span> <span class="fl">0.3</span>, early_stop_iter <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">opt_mbkm</span> <span class="op">=</span> <span class="fu">Optimal_Clusters_KMeans</span><span class="op">(</span><span class="va">dat</span>, max_clusters <span class="op">=</span> <span class="fl">10</span>, criterion <span class="op">=</span> <span class="st">"distortion_fK"</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>                                   plot_clusters <span class="op">=</span> <span class="cn">FALSE</span>, mini_batch_params <span class="op">=</span> <span class="va">params_mbkm</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#----------------------------</span></span></span>
<span class="r-in"><span><span class="co"># non-contiguous search space</span></span></span>
<span class="r-in"><span><span class="co">#----------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">search_space</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">opt_km</span> <span class="op">=</span> <span class="fu">Optimal_Clusters_KMeans</span><span class="op">(</span><span class="va">dat</span>, max_clusters <span class="op">=</span> <span class="va">search_space</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>                                 criterion <span class="op">=</span> <span class="st">"variance_explained"</span>,</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>                                 plot_clusters <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lampros Mouselimis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

