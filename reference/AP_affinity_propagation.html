<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Affinity propagation clustering — AP_affinity_propagation • ClusterR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Affinity propagation clustering — AP_affinity_propagation"><meta name="description" content="Affinity propagation clustering"><meta property="og:description" content="Affinity propagation clustering"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ClusterR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/the_clusterR_package.html">Functionality of the ClusterR package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mlampros/ClusterR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Affinity propagation clustering</h1>
      <small class="dont-index">Source: <a href="https://github.com/mlampros/ClusterR/blob/master/R/clustering_functions.R" class="external-link"><code>R/clustering_functions.R</code></a></small>
      <div class="d-none name"><code>AP_affinity_propagation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Affinity propagation clustering</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AP_affinity_propagation</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">p</span>,</span>
<span>  maxits <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  convits <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  dampfact <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  details <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nonoise <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  time <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a matrix. Either a similarity matrix (where number of rows equal to number of columns) or a 3-dimensional matrix where the 1st, 2nd and 3rd column correspond to (i-index, j-index, value) triplet of a similarity matrix.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>a numeric vector of size 1 or size equal to the number of rows of the input matrix. See the details section for more information.</p></dd>


<dt id="arg-maxits">maxits<a class="anchor" aria-label="anchor" href="#arg-maxits"></a></dt>
<dd><p>a numeric value specifying the maximum number of iterations (defaults to 1000)</p></dd>


<dt id="arg-convits">convits<a class="anchor" aria-label="anchor" href="#arg-convits"></a></dt>
<dd><p>a numeric value. If the estimated exemplars stay fixed for convits iterations, the affinity propagation algorithm terminates early (defaults to 100)</p></dd>


<dt id="arg-dampfact">dampfact<a class="anchor" aria-label="anchor" href="#arg-dampfact"></a></dt>
<dd><p>a float number specifying the update equation damping level in [0.5, 1). Higher values correspond to heavy damping, which may be needed if oscillations occur (defaults to 0.9)</p></dd>


<dt id="arg-details">details<a class="anchor" aria-label="anchor" href="#arg-details"></a></dt>
<dd><p>a boolean specifying if details should be printed in the console</p></dd>


<dt id="arg-nonoise">nonoise<a class="anchor" aria-label="anchor" href="#arg-nonoise"></a></dt>
<dd><p>a float number. The affinity propagation algorithm adds a small amount of noise to <em>data</em> to prevent degenerate cases; this disables that.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>a boolean. If TRUE then the elapsed time will be printed in the console.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <em>affinity propagation</em> algorithm automatically determines the number of clusters based on the input preference <em>p</em>, a real-valued N-vector. p(i) indicates the preference that data point i be
chosen as an exemplar. Often a good choice is to set all preferences to median(data). The number of clusters identified can be adjusted by changing this value accordingly. If <em>p</em> is a scalar, assumes all
preferences are that shared value.</p>
<p>The number of clusters eventually emerges by iteratively passing messages between data points to update two matrices, A and R (Frey and Dueck 2007). The "responsibility" matrix R has values r(i, k)
that quantify how well suited point k is to serve as the exemplar for point i relative to other candidate exemplars for point i. The "availability" matrix A contains values a(i, k) representing how
"appropriate" point k would be as an exemplar for point i, taking into account other points' preferences for point k as an exemplar. Both matrices R and A are initialized with all zeros. The AP
algorithm then performs updates iteratively over the two matrices. First, "Responsibilities" r(i, k) are sent from data points to candidate exemplars to indicate how strongly each data point favors
the candidate exemplar over other candidate exemplars. "Availabilities" a(i, k) then are sent from candidate exemplars to data points to indicate the degree to which each candidate exemplar is
available to be a cluster center for the data point. In this case, the responsibilities and availabilities are messages that provide evidence about whether each data point should be an exemplar and,
if not, to what exemplar that data point should be assigned. For each iteration in the message-passing procedure, the sum of r(k; k) + a(k; k) can be used to identify exemplars. After the messages
have converged, two ways exist to identify exemplars. In the first approach, for data point i, if r(i, i) + a(i, i) &gt; 0, then data point i is an exemplar. In the second approach, for data point i,
if r(i, i) + a(i, i) &gt; r(i, j) + a(i, j) for all i not equal to j, then data point i is an exemplar. The entire procedure terminates after it reaches a predefined number of iterations or if the
determined clusters have remained constant for a certain number of iterations... ( https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5650075/  – See chapter 2 )</p>
<p>Excluding the main diagonal of the similarity matrix when calculating the median as preference ('p') value can be considered as another option too.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>https://www.psi.toronto.edu/index.php?q=affinity<!-- %20propagation --></p>
<p>https://www.psi.toronto.edu/affinitypropagation/faq.html</p>
<p>https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5650075/    ( SEE chapter 2 )</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">255</span>, <span class="fl">2500</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">100</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">smt</span> <span class="op">=</span> <span class="fl">1.0</span> <span class="op">-</span> <span class="fu"><a href="distance_matrix.html">distance_matrix</a></span><span class="op">(</span><span class="va">dat</span>, method <span class="op">=</span> <span class="st">'euclidean'</span>, upper <span class="op">=</span> <span class="cn">TRUE</span>, diagonal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">smt</span><span class="op">)</span> <span class="op">=</span> <span class="fl">0.0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ap</span> <span class="op">=</span> <span class="fu">AP_affinity_propagation</span><span class="op">(</span><span class="va">smt</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">smt</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">ap</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ K                  : int 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ N                  : num 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ netsim             : num -41124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ dpsim              : num -34361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ expref             : num -6763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ iterations         : int 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ exemplars          : int [1:13] 0 8 18 26 36 42 64 66 73 75 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ idx                : num [1, 1:100] 0 73 75 42 66 64 64 18 8 75 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ clusters           :List of 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ 18: int [1:7] 7 18 51 53 68 79 93</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ 64: int [1:7] 5 6 37 44 46 64 78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ 92: int [1:6] 11 34 40 77 84 92</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ 66: int [1:9] 4 24 31 58 61 66 72 81 83</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ 94: int [1:13] 20 28 32 41 48 63 65 69 82 91 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ 42: int [1:8] 3 16 35 42 49 60 62 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ 36: int [1:10] 13 17 19 23 29 30 33 36 85 87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ 88: int [1:6] 10 55 70 80 88 89</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ 75: int [1:11] 2 9 47 56 57 71 75 86 90 97 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ 8 : int [1:6] 8 14 21 22 45 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ 73: int [1:5] 1 25 52 59 73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ 26: int [1:6] 26 38 39 54 67 76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ 0 : int [1:6] 0 12 15 27 43 74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ clusters_vectorized: int [1:100] 0 73 75 42 66 64 64 18 8 75 ...</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lampros Mouselimis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

